---
title: "פרק 4 - הסתברות מותנית ובייס - הגרסה אנושית"
weight: 5
---

# פרק 4 -- הסתברות מותנית ובייס -- הגרסה אנושית

## מה זה באמת הסתברות מותנית 

בפרק הקודם דיברנו על שאלה פשוטה:
**"כמה פעמים משהו קורה מתוך כל המקרים?"**
זו הסתברות בסיסית, והיא חשובה.
אבל בחיים האמיתיים -- ובטח בעולם ה-AI -- זו לא השאלה
שאנחנו באמת רוצים לשאול.

השאלה האמיתית היא אחרת לגמרי:
**"כמה פעמים משהו קורה בתוך קבוצה מסוימת?"**

זו הסתברות מותנית.
וברגע שמבינים אותה, העולם משתנה.

**דוגמה יומיומית**

אם אתה שואל:
"מה הסיכוי שירד היום גשם?"
זו שאלה כללית.

אבל אם אתה שואל:
"מה הסיכוי שירד היום גשם אם העננים כהים כבר שעה?"
זו שאלה אחרת לחלוטין.

ברגע שיש **הקשר**, הסיכוי משתנה.
אנחנו כבר לא בודקים את הכול
אלא **מצב** **חלקי**, תת-קבוצה.

וזה בדיוק מהות ההסתברות המותנית.

**וזה קורה כל הזמן בעולם של מודלים**

מודל לא שואל:
"מה ההסתברות שמשהו הוא ספאם?"
אלא:
**"מה ההסתברות שההודעה הזו ספאם** בהינתן **שהיא מכילה את המילה
****free?"**

או בעולם אחר:
**"מה הסיכוי שלקוח יעזוב, בהינתן שזו כבר הפנייה השלישית שלו
החודש?"**

או ב-NLP:
**"מה הסיכוי שמילה מסוימת תגיע עכשיו, בהינתן שלושת המילים
הקודמות?"**

שמת לב?
אין פה נוסחה.
יש הקשר.

**
**

**למה זה כל כך חשוב?**

כי מודלים לא עובדים על תדירויות "עיוורות".
הם לא מחפשים רק "מה קרה הרבה".
הם מחפשים גם:
**"מה קורה הרבה כשדברים מסוימים כבר קרו?"**

זו השפה האמיתית של דפוסים:

-   אם X קרה, כמה פעמים גם Y קרה?

-   אם מופיעה מילה מסוימת, מה המשמעות של זה בטקסט?

-   אם משתמש מתנהג בצורה מסוימת, מה זה אומר על הצעד הבא
    שלו?

זו הסתברות שמדברת כמו מתכנת:
פשוטה, הגיונית, מחוברת להקשר.

**וכאן מתחיל החיבור לבייס**

בייס הוא לא נוסחה כבדה.
הוא לא "מתמטיקה של סטטיסטיקאים".
הוא הדרך לחבר בין:

**העולם הכללי** ← כמה משהו נפוץ באופן כללי
**העולם שבהקשר** ← כמה הוא נפוץ בתוך תת-קבוצה
מסוימת

כדי להגיע לתשובה אחת:
**כמה סביר שזה נכון עכשיו.**

לפני שנגיע לבייס עצמו, צריך לבנות את השולחן שעליו הוא
עומד:
טבלאות פשוטות, מספרים קטנים, וספירה ישרה.

וזה בדיוק מה שנעשה בחלק הבא.

## בייס דרך טבלאות, לא דרך נוסחאות

כדי להבין את הרעיון של בייס בצורה **אנושית**, צריך לשים
בצד את הנוסחאות ואת כל ה P(X\|Y).
לפני הכול, בייס מתחיל מהסתכלות על **מספרים אמיתיים שמסודרים
בטבלה**.
שם מסתתר כל הרעיון.

אבל לפני שנצלול לתוך הדוגמה, חשוב להבהיר משהו קטן שמונע הרבה
בלבול:
**המילה בייס היא לא קיצור ולא ביטוי טכני.**
זה פשוט שמו של תומס בייס, כומר ומתמטיקאי שחי לפני כמה מאות
שנים.
בייס הציג רעיון שהיה חדשני לזמנו:
כשיש לנו ידע קודם ומגיע מידע חדש, צריך **לשלב** ביניהם ולא להתעלם משום
חלק.
זה הבסיס לכל מה שנקרא היום "חשיבה בייסיאנית".

עכשיו ניגש לטבלה.

הטבלה מספרת שני דברים חשובים:
**מה קורה בעולם בכלל**
**ומה קורה בתוך ההקשר שמעניין אותנו עכשיו**.

נראה את זה בדוגמה הכי ברורה: זיהוי ספאם.

סרקנו מיילים וספרנו כמה פעמים מופיעה המילה
"free".
זה מה שקיבלנו:

  ------------------------------------------------------------------------------
  מופע המילה \"free\"       ספאם   לא
                                                             ספאם
  -------------------------------------- ------------------- -------------------
  מופיעה                    42                  3

  לא מופיעה                 1158                797
  ------------------------------------------------------------------------------

זו טבלה קטנה, אבל היא מספרת סיפור גדול.

**איך קוראים את הטבלה?**

כש free מופיעה:

-   42 מקרים היו ספאם

-   3 בלבד היו הודעות רגילות

כלומר:
**כשfree בפנים -- הקונטקסט מוטה חזק לכיוון
ספאם.**

כשfree לא מופיעה:

-   1158 היו ספאם

-   797 היו רגילות

כאן התמונה הרבה פחות חדה.

הטבלה מציגה שני עולמות:

-   העולם הכללי -- כמה ספאם יש בכלל

-   העולם שבקונטקסט -- מה קורה כשהfree מופיעה
    או לא מופיעה

ובייס פשוט מחבר בין שני העולמות האלה.

**מה בייס בעצם שואל?**

הוא מסתכל על הטבלה ושואל: []
בהינתן שאני רואה free []

**איזה תרחיש הופיע יותר פעמים?**

או בניסוח \"אנושי\":
**מה יותר סביר עכשיו, בהתחשב במה שאני רואה מול העיניים?**

**וזה עובד לא רק בטקסט**

אותו עיקרון קורה גם בעולם של:

-   זיהוי הונאות

-   עזיבת לקוחות

-   אנומליות במערכות

-   זיהוי אובייקטים

-   כל תחום שיש בו סיווג

בכל פעם שיש לך קונטקסט, ובתוכו דפוסים שונים
טבלה כזו היא הכלי הכי חזק להבין מה קורה באמת.

לפני שנראה "כמה זה סביר" בצורה אינטואיטיבית,
נבין מה עומד מאחורי השאלה הזו.

## מה מסתתר מאחורי השאלה \"כמה סביר שזה נכון?\"

אחרי שמבינים איך נראית טבלת שכיחויות, מגיעה השאלה שהמודל באמת מנסה
לענות עליה.
זו לא השאלה \"האם זה נכון\" אלא השאלה \"כמה זה סביר\".

זו נקודה עדינה אבל משמעותית.
מודלים לא עובדים עם אמת מוחלטת.
הם עובדים עם רמזים, דפוסים והקשרים שמעלים או מורידים את הסיכוי
למשהו.

**איך מודל חושב על סבירות**

כשמודל מקבל הודעה חדשה, הוא לא יודע מראש מה היא.
הוא בודק מה הוא ראה בעבר.
הוא מחפש תבניות שמופיעות הרבה בתוך קבוצות מסוימות.

אם free הופיעה בעיקר בספאם
ואותה המילה מופיעה עכשיו
המודל מקבל רמז לכיוון מסוים.

אם hello מופיעה בעיקר בהודעות רגילות
ומופיעה גם כאן
זה רמז לכיוון אחר.

המודל שואל את עצמו שאלות כמו

-   האם הדפוס הזה מתאים למה שקורה בדרך כלל בקבוצה מסוימת?

-   האם מה שאני רואה עכשיו מאפיין מקרים שכבר הכרתי?

-   מה קרה בעבר במצבים דומים?

זו חשיבה הסתברותית שמבוססת על ניסיון, לא על הגדרה מתמטית.

**למה זו לא החלטה דיכוטומית**

המוח שלנו אוהב שחור ולבן.
מודלים עובדים באפור.
הם לא אומרים \"זו הודעה רגילה\" או \"זו הודעת ספאם\".
הם אומרים
**בהקשר הזה יש יותר ראיות לכאן מאשר לכאן.**

זה מה שהשאלה \"כמה סביר שזה נכון\" באמת אומרת.

**איך זה מתחבר לעבודה של מפתח**

כשאתה מבין שהמודל בודק סבירות ולא אמת מוחלטת
אתה פתאום קורא תוצאות בצורה אחרת.
אחוזים ומדדים מפסיקים להיות סתם מספרים
והופכים לרמזים למבנה הדאטה.

הבנה של סבירות עוזרת לך

-   לזהות הטיות

-   להבין למה מודל טעה

-   לשפר דאטה במקום לשפר קוד

-   לבנות לוגיקה עסקית שמתחשבת בסיכון ולא רק בתוצאה

במילים אחרות
לדעת לשאול \"כמה סביר\" היא מיומנות הנדסית לכל דבר.

בחלק הבא נראה איך כל זה נראה בקוד אמיתי וכמה פשוט אפשר להפוך דפוס מסובך
לכמה שורות פייתון.


## הדגמה קטנה בקוד שתגרום לזה להתחבר

אחרי שעברנו דרך הרעיון של הסתברות מותנית והבנו איך מודל מחבר בין הקשר
לבין תמונת העולם הרחבה, הגיע הזמן לראות את זה קורה בפועל.
לא נוסחאות.
לא מודל כבד.
רק טבלה, קצת ספירה, וכמה שורות פייתון.

נשתמש בדוגמה שכבר ראינו: המילה free בהודעות ספאם או
רגילות.

הטבלה שלנו נראית כך:

  ------------------------------------------------------------------------------
  מופע המילה \"free\"       ספאם   לא
                                                             ספאם
  -------------------------------------- ------------------- -------------------
  מופיעה                    42                  3

  לא מופיעה                 1158                797
  ------------------------------------------------------------------------------

בוא נתרגם את הטבלה לפייתון ונראה מה המודל היה \"מרגיש\" כשהוא מקבל
הודעה עם free.

import numpy as np

\# טבלת שכיחויות

spam_with_free = 42

ham_with_free = 3

spam_without_free = 1158

ham_without_free = 797

\# סך הכל הודעות בכל קטגוריה

total_spam = spam_with_free + spam_without_free

total_ham = ham_with_free + ham_without_free

\# הסתברויות בסיסיות

p_spam = total_spam / (total_spam + total_ham)

p_ham = total_ham / (total_spam + total_ham)

\# הסתברות מותנית לפי תדירות

p_free_given_spam = spam_with_free / total_spam

p_free_given_ham = ham_with_free / total_ham

print(\"הסתברות בסיסית לספאם:\", round(p_spam, 3))

print(\"הסתברות בסיסית להודעה רגילה:\", round(p_ham, 3))

print(\"הסתברות לראות free בתוך ספאם:\",
round(p_free_given_spam, 3))

print(\"הסתברות לראות free בהודעות רגילות:\",
round(p_free_given_ham, 3))

מה קורה כאן בפועל?

1.  **מחשבים כמה ספאם יש בכלל**

> לא תמיד צריך את זה, אבל זה נותן תמונת רקע.
> אם יש הרבה ספאם בעולם -- הודעה חדשה גם נבחנת בתוך רגישות גבוהה
> יותר.

2.  **בודקים כמה פעמים free מופיעה בכל קבוצה**

> זה לב הסיפור.
> המודל לא שואל \"כמה פעמים free מופיעה\".
> הוא שואל \"כמה פעמים free מופיעה בתוך ספאם\" ו\"בתוך לא
> ספאם\".

3.  **משווים בין שתי ההסתברויות**

> אם free מופיעה יותר בספאם מאשר בהודעות
> רגילות
> המודל יטה לכיוון ספאם
> גם אם זה לא ודאות מוחלטת.
>
> זה בדיוק \"כמה סביר שזה נכון\".

4.  **הסיפור מאחורי המספרים**

> אם תפעיל את הקוד, תראה שמשהו בולט מיד:
> הסתברות להופעת free בתוך ספאם גבוהה בצורה
> קיצונית
> והיא נמוכה מאוד בתוך הודעות רגילות.

במילים אחרות
אם free מופיעה -- הסיכוי לספאם עולה משמעותית.

זו לא נוסחה.
זו הבנה דרך דפוסים.

וזה הלב של בייס:
שילוב בין תדירות כללית לבין תדירות בתוך הקשר.

**סיכום**

הסתברות מותנית ובייס הם לא חומרים תיאורטיים כבדיים, אלא כלים מעשיים שכל
מפתח צריך להבין ברמה אנושית.
כשאתה מבין

-   כמה דברים קורים בתוך הקשר

-   איך מודל בודק סבירות

-   איך טבלה פשוטה מספרת סיפור

אתה כבר לא מפחד מהסטטיסטיקה שמאחורי מודלים.
אתה קורא אותה כמו שפה.

פרק זה מספק לך את היכולת להסתכל על מודלים מתוך עולם של סבירות ולא מתוך
עולם של ניחושים.
וזו מיומנות שתשרת אותך בכל מודל, בכל קוד, בכל מערכת.

