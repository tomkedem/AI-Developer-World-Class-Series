---
title: "פרק 11 - עבודה בסביבה אמיתית"
weight: 12
---

## **פרק 11 - עבודה בסביבה אמיתית**
### קוד legacy
רוב המערכות האמיתיות לא נכתבו אתמול.  


הן גדלו שכבה על שכבה, עם החלטות שעשו הגיון בזמנן,  


ועם קוד שאף אחד כבר לא זוכר למה הוא נראה כמו שהוא נראה.  



זה קוד legacy.  


לא בהכרח קוד גרוע.  


קוד ותיק.  



סוכן קוד לא מבדיל בין חדש לישן.  


אם לא אומרים לו אחרת,  


הוא יתייחס לקוד legacy כמו לכל קוד אחר:  


משהו שאפשר לשפר, לפשט, או “לנקות”.  



ופה בדיוק הסכנה.  



בקוד legacy, שינוי קטן יכול לשבור התנהגות שאף אחד כבר לא יודע להסביר,  


אבל מישהו עדיין תלוי בה.  



מתכנת שמכוון עבודה לא נותן לסוכן “לעשות סדר” בקוד legacy.  


הוא קודם מבקש הבנה.  



מה התפקיד של הקוד הזה היום.  


איפה הוא נוגע במערכת.  


ואיזה שינוי נחשב בטוח לעומת כזה שמצריך זהירות מיוחדת.  



לפעמים המסקנה היא לא לגעת בכלל.  


לפעמים רק להקיף בבדיקות.  


ולפעמים לעשות שינוי קטן ומדוד מאוד.  



העיקרון פשוט:  


בקוד legacy לא מתחילים בשיפור,  


מתחילים בכבוד.  



### טסטים שבורים

טסטים שבורים הם רעש קבוע בסביבות אמיתיות.  


לפעמים הם שבורים כבר חודשים.  


לפעמים הם נכשלו בגלל שינוי אחר לגמרי.  


ולפעמים אף אחד לא בטוח אם הם עדיין רלוונטיים.  



כשסוכן קוד פוגש טסטים שבורים, הוא מנסה “לתקן”.  


להתאים את הקוד.  


לעדכן ציפיות.  


או פשוט לעקוף.  



אבל טסט שבור הוא לא בהכרח בעיה בקוד.  


לפעמים הוא עדות לכך שהמערכת השתנתה,  


והבדיקות לא התעדכנו יחד איתה.  



מתכנת שמכוון עבודה לא נותן לסוכן לרוץ ולתקן טסטים אוטומטית.  


הוא קודם שואל:  

- מה הטסט הזה ניסה להגן עליו  
- האם ההתנהגות שהוא בודק עדיין רצויה  
- והאם הכישלון שלו הוא סימן לבעיה אמיתית או רק חוב ישן  



רק אחרי שהשאלות האלה נענו,  


יש טעם להחליט אם לתקן, לעדכן, או למחוק.  



טסטים שבורים הם לא מכשול.  


הם הזדמנות להבין את הפער בין איך שהמערכת אמורה לעבוד  


לאיך שהיא באמת עובדת היום.  



### CI שלא עובר

CI הם בדיקות אוטומטיות שרצות בכל שינוי קוד.  


המטרה שלהן פשוטה: לבדוק שהמערכת עדיין עובדת אחרי שינוי.  



במערכת אידיאלית, אם ה-CI אדום, משהו באמת לא תקין.  


במערכת אמיתית, זה לא תמיד המצב.  



לפעמים ה-CI נשבר בגלל שינוי ישן.  


לפעמים בגלל בדיקות שלא עודכנו.  


ולפעמים פשוט כי אף אחד לא טיפל בזה בזמן.  



כשסוכן קוד פוגש CI שלא עובר,  


הוא נוטה לראות בזה בעיה שחייבים לפתור מיד.  



לתקן בדיקות.  


לעדכן קונפיגורציה.  


או “לסדר” את המערכת כדי שהכול יהיה ירוק.  



ופה צריך לעצור.  



CI שלא עובר הוא לא בהכרח חלק מהמשימה.  


לפעמים הוא רק הרקע.  



מתכנת שמכוון עבודה לא נותן לסוכן לרדוף אחרי ירוק בכל מחיר.  


הוא קודם מגדיר:  

- האם הבדיקות האלה רלוונטיות לשינוי הנוכחי  
- אילו כשלים באמת חוסמים  
- ואילו אפשר להשאיר לטיפול נפרד  



CI הוא כלי חשוב,  


אבל גם אותו צריך לדעת לנהל, לא רק לציית לו.  



### פרויקטים מבולגנים

לא כל פרויקט מסודר כמו בספרים.  


ובמציאות, רובם לא.  



תיקיות בלי היגיון ברור.  


קבצים עם שמות כלליים מדי.  


קוד שנוגע בכמה אחריות בו זמנית.  



זה לא חריג.  


זה היומיום.  



כשסוכן קוד נכנס לפרויקט מבולגן,  


הוא מחפש סדר.  



הוא מנסה לארגן, לאחד, “לנקות”.  



אבל ניקיון בלי הבנה הוא מתכון לבעיות.  



בפרויקט מבולגן, הסדר החיצוני לא תמיד משקף את הסדר הפנימי.  


דברים שנראים מקריים מחוברים עמוק ללוגיקה עסקית.  


וקיצורי דרך הפכו עם הזמן לחלק מהמערכת.  



מתכנת שמכוון עבודה לא מבקש מהסוכן “לעשות סדר” בפרויקט כזה.  


הוא מבקש ממנו קודם להבין איך עובדים כאן באמת.  



איפה השינויים עוברים בדרך כלל.  


איזה קבצים נוגעים בהם בזהירות.  


ואיזה בלגן הוא רק בלגן, ואיזה הוא סימן לאילוץ עמוק יותר.  



רק אחרי שההבחנה הזו ברורה,  


יש מקום לשיפור.  



ובלא מעט מקרים,  


ההחלטה הנכונה היא לא לסדר הכול,  


אלא לגעת במינימום שנדרש כדי להתקדם בלי לשבור דברים.  



### מה עושים כשאין מסמכים ואין סדר

יש מערכות שבהן אין כמעט תיעוד.  


אין תרשימים.  


אין הסברים.  


ולפעמים גם אין מי לשאול.  



זה לא מקרה קצה.  


זו מציאות נפוצה.  



כשסוכן קוד נכנס לסביבה כזו,  


הוא נשאר בלי עוגנים.  



אין לו למה להשוות.  


אין לו “אמת” חיצונית לבדוק מולה את ההנחות שלו.  



במצב כזה, הסיכון הגדול ביותר הוא לרוץ קדימה מהר מדי.  


לשנות לפני שמבינים.  


ולבנות על ניחושים שנשמעים סבירים.  



מתכנת שמכוון עבודה מאט בכוונה.  


הוא משתמש בקוד עצמו כמסמך.  



קורא זרימות.  


מחפש נקודות חיבור.  


ומתקדם בצעדים קטנים שניתנים לביטול.  



הסוכן יכול לעזור כאן מאוד,  


אבל רק אם מגדירים לו תפקיד נכון:  


לא “לתקן”,  


אלא “לגלות”.  



לזהות איך המערכת באמת עובדת היום,  


לפני שמנסים לשנות אותה.  



וברגע שעובדים כך,  


גם מערכת בלי מסמכים ובלי סדר  


הופכת למשהו שאפשר להבין,  


ולאט לאט גם לשפר.
